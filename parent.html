<!DOCTYPE html>
<html>
	<head>
		<title>Parent - Embeddable App Test</title>

		<script type="text/javascript" src="https://rawgithub.com/millermedeiros/js-signals/master/dist/signals.min.js"></script>
		<script type="text/javascript" src="https://rawgithub.com/millermedeiros/Hasher/master/dist/js/hasher.min.js"></script>
		<script type="text/javascript" src="//unhassle.brennanmceachran.com/embedded-app.js"></script>
	</head>
	<body>
		<h1>Parent Page</h1>
		<p>sadas</p>
		<hr>

		<div id="app-backdrop" style="position:fixed;top:0;left:0;bottom:0;right:0;background:#000;opacity:0.3;display:none;z-index:0;"></div>
		<div id="app-area" style="position:relative;background:red;padding:20px;z-index:1;"></div>

		<script type="text/javascript">
			(function () {
				'use strict';

				var addevent = function addevent(element, eventName, eventFunction) {
					if(element.attachEvent) {
						//Internet Explorer
						element.attachEvent("on" + eventName, function() {eventFunction.call(element);});
					} else if(element.addEventListener) {
						// Standards
						element.addEventListener(eventName, eventFunction, false); //don't need the 'call' trick because in FF everything already works in the right way          
					}
				};

				var appBackdrop = document.getElementById('app-backdrop');
				var embeddedApp = EmbeddableApp.insert('app-area', {
					url: 'http://soapbox.dev/',
					proxyUrl:	'http://soapbox.dev/tools/proxy',
					proxyHash:	true,
					resize:		true,
					debug:		true
				});
				
				embeddedApp.on({
					modalOpen: function (payload) {
						//debugger;
						appBackdrop.style.display = 'block';
					},
					modalClose: function(payload) {
						//debugger;
						appBackdrop.style.display = 'none';
					}
				});

				addevent(appBackdrop, 'click', function(){
					appBackdrop.style.display = 'none';
					embeddedApp.send('modalClose', {});
				});
			}());
		</script>
	</body>
</html>